---
title: "1_finding_output_theme"
format: html
editor: visual
---

## Shiny app created by chatgpt

Order: I want to create a visually appealing map format and develop a shiny app where you can mark points on the map by inputting coordinates. How can I do this?

```{r}
install.packages(c("shiny", "leaflet"))
```
```{r}
library(shiny)
library(leaflet)

ui <- fluidPage(
  titlePanel("ğŸ“ è¾“å…¥åæ ‡åœ¨åœ°å›¾ä¸Šæ‰“ç‚¹"),
  
  sidebarLayout(
    sidebarPanel(
      numericInput("lat", "çº¬åº¦ (Latitude):", value = 39.90, step = 0.001),
      numericInput("lng", "ç»åº¦ (Longitude):", value = 116.40, step = 0.001),
      textInput("label", "æ ‡ç­¾ (å¯é€‰):", value = "æ ‡è®°ç‚¹"),
      actionButton("add", "æ·»åŠ ç‚¹"),
      actionButton("clear", "æ¸…é™¤æ‰€æœ‰ç‚¹")
    ),
    
    mainPanel(
      leafletOutput("map", height = "600px")
    )
  )
)

server <- function(input, output, session) {
  # åˆå§‹åŒ–åœ°å›¾
  output$map <- renderLeaflet({
    leaflet() %>%
      addProviderTiles(providers$CartoDB.Positron) %>%  # åœ°å›¾æ ·å¼
      setView(lng = 116.40, lat = 39.90, zoom = 4)
  })
  
  # å­˜å‚¨ç‚¹æ•°æ®
  points <- reactiveVal(data.frame(lat = numeric(), lng = numeric(), label = character()))
  
  # æ·»åŠ ç‚¹
  observeEvent(input$add, {
    new_point <- data.frame(lat = input$lat, lng = input$lng, label = input$label)
    points(rbind(points(), new_point))
    
    leafletProxy("map") %>%
      addMarkers(
        lng = input$lng,
        lat = input$lat,
        popup = input$label
      )
  })
  
  # æ¸…é™¤ç‚¹
  observeEvent(input$clear, {
    points(data.frame(lat = numeric(), lng = numeric(), label = character()))
    leafletProxy("map") %>% clearMarkers()
  })
}

shinyApp(ui, server)

```

